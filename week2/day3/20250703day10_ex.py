import pandas as pd

data = {
    '지점': ['강남', '강남', '홍대', '홍대', '강남', '신촌', '신촌', '강남', '홍대', '신촌'],
    '카테고리': ['음료', '과자', '음료', '과자', '담배', '과자', '음료', '과자', '담배', '담배'],
    '상품명': ['콜라', '새우깡', '사이다', '포카칩', '에쎄', '초코파이', '이프로', '칸쵸', '말보로', '보헴'],
    '판매수량': [120, 80, 60, 90, 200, 55, 100, 40, 180, 150],
    '단가': [1500, 1200, 1500, 1300, 4500, 1000, 1600, 1100, 5000, 4700]
}
df = pd.DataFrame(data)
df['매출'] = df['판매수량'] * df['단가']
df

#1. 지점별 총매출, 평균매출
df.groupby('지점')['매출'].agg(['sum','mean'])

#2. 카테고리별 평균 판매 수량, 표준편차
df.groupby('카테고리')['판매수량'].agg(['mean','std'])

#3. 지점별 가장 많이 팔린 상품
df.loc[df.groupby('지점')['판매수량'].idxmax()]

#4. 지점+카테고리 조합으로 평균 매출
df.groupby(['지점','카테고리'])['매출'].mean()

#5. 전체 상품 중 판매량 Top 3
df.sort_values(by='판매수량', ascending=False).head(3)

#6. 카테고리별 총매출이 가장 높은 지점
df.groupby(['카테고리','지점'])['매출'].sum().groupby(level=0).idxmax()

#7. 카테고리별 가장 인기 상품(판매수량 기준)
df.loc[df.groupby('카테고리')['판매수량'].idxmax()]