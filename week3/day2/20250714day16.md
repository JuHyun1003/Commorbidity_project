# 16일차(2025.07.014)
## 개요
- 단변수 선형 회귀분석 학습
## 학습 내용
### 진도
- 아래 데이터를 이용해서 `월구독료`->`건강점수` 예측
```python
import pandas as pd
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt
import matplotlib
from sklearn.metrics import mean_squared_error, r2_score
df=pd.read_csv('C:/portfolio/code/week2/day7/gym_members.csv')
df=df.set_index('이름')
```
- 회귀분석 결과 예측 : 두 변수 사이의 상관계수가 0.02로 매우 작다. 따라서 실제 값과 예측값의 차이가 심할것이다.
```python
df['월구독료'].corr(df['건강점수'])

#결과
np.float64(0.023868878393949283)
```
1. 변수 설정
```python
x=df[['월구독료']] #2차원이므로 []2개
y=df['건강점수']
```
2. 모델 훈련
```python
model=LinearRegression()
model.fit(x,y)
```
3. 계수 확인
```python
print('기울기 :', model.coef_[0]) #x가 1증가할 때, y가 얼마나 증가?
print('절편 :', model.intercept_)

#결과
>>> print('기울기 :', model.coef_[0])
기울기 : 1.26700755642533e-05
>>> print('절편 :', model.intercept_)
절편 : 62.463166778314864
```

4. 예측값 구하기
```python
y_pred = model.predict(x)
df['건강예측점수']=y_pred

#결과
   성별  나이  운동경력  주당운동일수   선호기구   보충제    월구독료  건강점수  인바디체지방률   근육량  식단유지여부     예측건강점수
이름
지훈  남  21     7       5  레그프레스   안 씀  118603  82.4     25.8  68.3       1  63.965876
민서  여  31     2       5     덤벨   안 씀   92256  67.2     31.8  49.7       1  63.632057
서준  남  25     4       5    케틀벨  크레아틴  129135  68.8     30.1  55.6       1  64.099317
예은  남  21     9       1    케틀벨  크레아틴   75222  63.5     14.7  61.1       0  63.416235
도윤  남  20     2       3  스미스머신  크레아틴  117373  41.4     32.3  50.9       1  63.950292
수아  여  31    10       5    케틀벨   단백질  119575  45.9     23.5  69.2       0  63.978191
현우  남  31     9       4  스미스머신   안 씀  136354  41.7     30.2  68.9       0  64.190782
하은  남  36    10       6     덤벨  크레아틴  124651  75.0     32.4  47.6       1  64.042504
태현  남  29     5       1  레그프레스  크레아틴  103335  57.3     18.0  54.9       0  63.772429
지아  여  35     2       1  레그프레스   단백질   50965  68.0     12.8  49.0       0  63.108897
서윤  남  34     4       3  레그프레스  크레아틴   64538  89.9     15.7  48.5       0  63.280868
하진  남  34     7       1    케틀벨   단백질  148066  53.7     20.7  41.1       1  64.339174
민재  남  38     8       1     덤벨  BCAA  110592  62.6     30.5  58.3       1  63.864376
윤아  남  31     3       5    케틀벨  크레아틴  138018  81.6     31.5  55.1       0  64.211865
지후  여  39     1       3    케틀벨  BCAA   48110  52.6     10.2  41.5       1  63.072724
채원  남  22     4       5     덤벨   단백질  119309  44.2     22.8  48.4       1  63.974821
준서  여  24     2       6     덤벨   안 씀   67266  55.9     20.4  67.2       1  63.315432
다은  여  38     8       7     덤벨  크레아틴   92992  48.9     15.6  47.2       1  63.641382
현서  여  26     4       6     덤벨   단백질  122948  91.1     13.0  44.3       0  64.020927
예진  남  28     2       7  레그프레스   안 씀  138806  84.4     18.4  54.7       0  64.221849
```
5. 시각화
```python
def today(df):
    matplotlib.rc('font', family=('Malgun Gothic'))
    plt.figure=(figsize=(8,6))
    plt.scatter(x,y,label='실제건강점수', alpha=0.7)
    plt.plot(x,y_pred,color='red', label='예측회귀선')
    plt.xlabel('월구독료')
    plt.ylabel('건강점수')
    plt.title('단변수 선형회귀')
    plt.legend()
    plt.grid()
    plt.show()
```
[단변수 선형회귀](단변수선형회귀.png)

6. 성능평가
```python
df['건강점수'].agg(['min', 'max']) # 예측하고자 하는 값의 범위를 알기 위함

#결과
min    41.4
max    91.1
```
- mse : 오차 제곱 평균 -> 작을수록 좋음 (y스케일에 따라 다름)
```python
mse=mean_squared_error(y,y_pred)
print(mse)

#결과
247.04364823140494
```
- 해석 : min과 max 값의 차이가 50이다. 그러나 평균오차 제곱이 250가까이 나왔다는 것은, 오차가 매우 크게 발생한다는 것을 의미한다. mse에 루트를 씌운 rmse 값이 약 15 정도이니, 예측값에서 평균적으로 15 정도의 오차가 발생함을 알 수 있다.
---
- R^2 : 설명력(0.0~1.0 범위) -> 1에 가까울수록 좋음
```python
r2=r2_score(y,y_pred)
print(r2)

#결과
0.0005697233557854231
```
- 해석 : R^2값이 거의 0에 가깝다. 따라서 모델이 x와 y사이의 관계를 거의 못잡고 있다.
---
따라서, 기존에 예측한 결과값과 실제 모델의 결과가 거의 일치한다.